<<<<<<< HEAD
﻿<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="BookCafe_ProductManagemnet_Modify" width="1020" height="720" titletext="제품관리" oninit="BookCafe_ProductManagemnet_Modify_oninit">
    <Layouts>
      <Layout height="720" mobileorientation="landscape" width="1020">
        <Static id="Static00" taborder="0" text="제품관리" left="20" font="24px/normal &quot;Gulim&quot;" height="45" top="5" right="20" border="0px none, 0px none, 1px solid dimgray"/>
        <Combo id="fir_category" taborder="1" text="" left="20" top="120" width="100" height="30" value="" index="-1" innerdataset="init_fir_code" codecolumn="FIR_CODE" datacolumn="FIR_NAME" border="1px solid #4F4537" onitemchanged="fir_category_onitemchanged" cssclass="combo_default"/>
        <Combo id="sec_category" taborder="2" top="120" width="100" height="30" value="" index="-1" text="" innerdataset="sec_code" codecolumn="SEC_CODE" datacolumn="SEC_NAME" left="fir_category:10" border="1px solid #4F4537" onitemchanged="sec_category_onitemchanged" cssclass="combo_default"/>
        <Grid id="Grid00" taborder="6" left="20" top="155" bottom="20" right="20" binddataset="view_code" autofittype="col" border="1px solid #4F4537" onheadclick="Grid00_onheadclick" oncelldblclick="Grid00_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="20"/>
                <Column size="48"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkboxcontrol" edittype="checkbox" background="#FFF8EE" checkboxfalsevalue="0" checkboxtruevalue="1" text="bind:chx"/>
                <Cell col="1" text="NO" background="#FFF8EE" textAlign="left"/>
                <Cell col="2" text="제품코드" background="#FFF8EE" textAlign="left"/>
                <Cell col="3" text="카테고리" background="#FFF8EE" textAlign="left"/>
                <Cell col="4" text="제품명" background="#FFF8EE" textAlign="left"/>
                <Cell col="5" text="가격" background="#FFF8EE" textAlign="right"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkboxcontrol" edittype="checkbox" textAlign="center" checkboxtruevalue="1" checkboxfalsevalue="0" text="bind:chx"/>
                <Cell col="1" text="bind:num"/>
                <Cell col="2" text="bind:PRODUCT_CODE"/>
                <Cell col="3" text="bind:SEC_NAME"/>
                <Cell col="4" text="bind:PRODUCT_NAME" edittype="text"/>
                <Cell col="5" text="bind:PRODUCT_PRICE" edittype="text" displaytype="mask" maskeditformat=",000" maskeditpostfixtext="원"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_del" taborder="5" text="삭제" width="70" height="30" right="20" bottom="Grid00:5" cssclass="btn_dafault" onclick="btn_del_onclick"/>
        <Button id="btn_save" taborder="4" text="저장" width="70" height="30" right="btn_del:10" bottom="Grid00:5" cssclass="btn_dafault" onclick="btn_save_onclick"/>
        <Button id="btn_add" taborder="3" text="신규" width="70" onclick="btn_add_onclick" right="btn_save:10" bottom="Grid00:5" height="30" cssclass="btn_dafault"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="init_fir_code" useclientlayout="true">
        <ColumnInfo>
          <Column id="FIR_CODE" type="STRING" size="256"/>
          <Column id="FIR_NAME" type="STRING" size="256"/>
          <Column id="USE_STATUS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="view_code" useclientlayout="true" onrowposchanged="view_code_onrowposchanged">
        <ColumnInfo>
          <Column id="SEC_CODE" type="STRING" size="256"/>
          <Column id="SEC_NAME" type="STRING" size="256"/>
          <Column id="PRODUCT_NAME" type="STRING" size="256"/>
          <Column id="PRODUCT_PRICE" type="INT" size="256"/>
          <Column id="PRODUCT_CODE" type="STRING" size="256"/>
          <Column id="chx" type="STRING" size="256"/>
          <Column id="num" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="fir_category_select" useclientlayout="true">
        <ColumnInfo>
          <Column id="FIR_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="sec_code" useclientlayout="true">
        <ColumnInfo>
          <Column id="SEC_CODE" type="STRING" size="256"/>
          <Column id="SEC_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="choice_sec_code" useclientlayout="true">
        <ColumnInfo>
          <Column id="SEC_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="del_date" useclientlayout="true">
        <ColumnInfo>
          <Column id="PRODUCT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="save_date">
        <ColumnInfo>
          <Column id="PRODUCT_CODE" type="STRING" size="256"/>
          <Column id="PRODUCT_NAME" type="STRING" size="256"/>
          <Column id="PRODUCT_PRICE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[
//화면 시작 시
this.BookCafe_ProductManagemnet_Modify_oninit = function(obj:nexacro.Form,e:nexacro.EventInfo)
{	
	this.sec_category.set_enable(false)// 중분류 카테고리 잠그기

	//대분류 카테고리 가져오기
	
	var id = "init_fir_code"
	var url = "svc::init_fir_code.do";
	var set = ""; 
	var get = "init_fir_code = init_fir_code";
	var arg = "";
	var callback = "fn_category";
	
	this.transaction(id, url, set, get, arg, callback)
		
		var id = "view_code"
		var url = "svc::view_code.do";
		var set = "";
		var get = "view_code = view_code";
		var arg = "";
		var callback = "fn_category";
		
		this.transaction(id, url, set, get, arg, callback)

}


//대분류 카테고리 선택 시
this.fir_category_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	this.sec_category.set_enable(true) // 중분류 카테고리 열기
	var select_category = this.fir_category.value;
	this.fir_category_select.setColumn(0,"FIR_CODE",select_category)
	
	var id = "fir_category_select"
	var url = "svc::fir_category_select.do";
	var set = "fir_category_select = fir_category_select"; 
	var get = "view_code = fir_category_select";
	var arg = "";
	var callback = "fn_category";
	
	this.transaction(id, url, set, get, arg, callback)
	
	
	var id = "select_sec_code"
	var url = "svc::select_sec_code.do";
	var set = "fir_category_select = fir_category_select";
	var get = "sec_code = sec_code";
	var arg = "";
	var callback = "fn_category";
			
	this.transaction(id, url, set, get, arg, callback)


}

















//카테고리 콜백 함수
this.fn_category = function(id, code, message){

	if(code == 0){
			switch(id) {
			case "fir_category_select":
				
				if(this.sec_code.getColumn(0,"SEC_NAME") == "전체"){
				this.sec_code.deleteRow(0)
		}
				break;
				
				case "del_date":
				this.reload()
			
			}
		
		}
	
	

}

//신규 등록버튼 클릭 시
this.btn_add_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
        var objChildFrame = new ChildFrame();
						// 팝업명 ,		상,하,좌,우, 좌측앵커, 우측앵커, 팝업할 xfdl
        objChildFrame.init("Product_popup", 0, 0, 400, 350, null, null, "FrameBase::BookCafe_AddProduct_popup.xfdl");
        objChildFrame.set_dragmovetype("all"); // 마우스 드래그
        objChildFrame.set_openalign("center middle"); // 화면 위치 
		objChildFrame.set_resizable(false); // 화면 크기 조절
		
        objChildFrame.showModal(this.getOwnerFrame(), null, this, "");
    } 
	



//중분류 카테고리 선택시
this.sec_category_onitemchanged = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{
	var sec_code = this.sec_category.value
	this.choice_sec_code.setColumn(0,"SEC_CODE",sec_code)
	
			id = "choice_sec_code"
			url = "svc::choice_sec_code.do";
			set = "choice_sec_code = choice_sec_code";
			get = "view_code = view_code";
			arg = "";
			callback = "fn_category";
			
			this.transaction(id, url, set, get, arg, callback)
	
};


//저장 클릭 시 
this.btn_save_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var a = 0;
	for(i = 0; i < this.view_code.rowcount; i++){
	if(this.view_code.getColumn(i,"chx") == 1){
	var code =	this.view_code.getColumn(i,"PRODUCT_CODE")
	var name =	this.view_code.getColumn(i,"PRODUCT_NAME")
	var price = this.view_code.getColumn(i,"PRODUCT_PRICE")

		
		this.save_date.addRow();
		
		this.save_date.setColumn(a,"PRODUCT_CODE",code)
		this.save_date.setColumn(a,"PRODUCT_NAME",name)
		this.save_date.setColumn(a,"PRODUCT_PRICE",price)
		a++;
	};
	}
		alert(this.save_date.saveXML());
	
	var id = "modi"
	var url  = "svc::modi.do"
	var set = "save_date = save_date:u"
	var get = ""
	var arg = ""
	var	callback = "fn_category";
			
	this.transaction(id, url, set, get, arg, callback)
	
};


// 데이터 셋의 ROW의 값이 변경되면 
this.view_code_onrowposchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSRowPosChangeEventInfo)
{
//변경 된 값의 ROW의 갯 수 만큼 그리드 안의 NUM에 갯수 표시
	for(i = 0; i < this.view_code.getRowCount(); i++){
	this.view_code.setColumn(i, "num", i+1+"번")
	}
};

//grid 맨 위의 체크박스 클릭 시 
this.Grid00_onheadclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	for(i = 0; i < this.view_code.getRowCount(); i++){
			this.view_code.setColumn(i,"chx",1);
		
	}
};

//삭제 버튼
this.btn_del_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
var num = 0 ;
	var con = this.confirm("정말 삭제 하시겠습니까?")
	
	if(con == true){

	//그리드의 전체 숫자만큼 반복 
	for(i = 0; i < this.view_code.getRowCount(); i++){

			// 걔 중 체크항목을 확인하고
			if(this.view_code.getColumn(i,"chx") == 1){ // 체크항목이 존재한다면
				
				this.del_date.addRow()// 데이터셋에 공간을 만들고
				alert(num)
				//삭제값만 dataset에 저장
				var code = this.view_code.getColumn(i,"PRODUCT_CODE")//체크된 값의 코드를 가져옴
				this.del_date.setColumn(num,"PRODUCT_CODE",code)// 그리고 저장
			num++;
			alert(num +"후" );
		}
	
	
	
	}
		if(this.del_date.getRowCount() == 0){
		
			alert("제품을 선택해주세요")
			return false;
			
	
		}else {
			alert(this.del_date.saveXML())
			var id = "del_date"
			var url = "svc::del_date.do";
			var set = "del_date = del_date";
			var get = "";
			var 	arg = "";
			var	callback = "fn_category";
			
			this.transaction(id, url, set, get, arg, callback)
		
		
		
		}
	}
			
	
				
			
			
			
		
		
	

};

//수정 더블클릭
this.Grid00_oncelldblclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	this.view_code.setColumn(e.row,"chx",1);//더블클릭한 cell의 체크박스 체크표시로 전환
	
};
]]></Script>
    <Bind>
      <BindItem id="item0" compid="fir_category" propid="text" datasetid="init_fir_code" columnid="FIR_NAME"/>
      <BindItem id="item1" compid="sec_category" propid="text" datasetid="sec_set" columnid="SEC_NAME"/>
    </Bind>
  </Form>
</FDL>
=======
﻿<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="BookCafe_ProductManagemnet_Modify" width="1020" height="720" titletext="제품관리" oninit="BookCafe_ProductManagemnet_Modify_oninit">
    <Layouts>
      <Layout height="720" mobileorientation="landscape" width="1020">
        <ListView id="ListView00" taborder="0" left="20" binddataset="product" top="130" bottom="20" right="20" oncellclick="ListView00_oncellclick" border="1px solid #4F4537" onselectchanged="ListView00_onselectchanged">
          <Formats>
            <Format id="default">
              <Band id="body" width="100%" height="100">
                <Cell id="Cell01" left="30" text="bind:PRODUCT_CODE" bottom="5" height="25" width="150" opacity="0.7"/>
                <Cell id="Cell08" left="30" top="5" width="150" bottom="5" text="이미지 준비중" textAlign="center"/>
                <Cell id="Cell07" left="190" width="180" text="bind:SEC_NAME" top="36" bottom="37" border="1px none #dbdee2" color="gainsboro"/>
                <Cell id="Cell03" left="Cell08:10" top="5" width="240" text="bind:PRODUCT_NAME" bottom="Cell07:5" edittype="text" border="1px none #dbdee2" font="18px/normal &quot;Gulim&quot;"/>
                <Cell id="Cell05" left="220" top="68" width="60" height="25" text="bind:PRODUCT_PRICE" displaytype="mask" maskeditformat="0,000" edittype="text" border="1px none black" font="18px/normal &quot;Gulim&quot;"/>
                <Cell id="btn_modi" top="7" width="101" height="30" text="수정" textAlign="center" right="17" borderRadius="5px" border="1px none #dbdee2" displaytype="buttoncontrol" edittype="button"/>
                <Cell id="chk_box" left="5" top="5" width="25" height="25" displaytype="checkboxcontrol" edittype="checkbox" border="1px none #dbdee2" checkboxsize="25"/>
                <Cell id="Cell00" left="193" top="68" width="25" height="25" border="1px none black" text="₩" font="18px/normal &quot;Gulim&quot;"/>
              </Band>
            </Format>
          </Formats>
        </ListView>
        <Static id="Static00" taborder="1" text="제품관리" left="1.96%" width="128" height="37" top="2.78%" cssclass="main_title"/>
        <Combo id="Combo00_00" taborder="3" text="카테고리" width="150" height="30" value="" index="-1" cssclass="combo_default" bottom="ListView00:5" left="180"/>
        <Combo id="Combo00" taborder="2" text="카테고리" height="30" value="" index="-1" cssclass="combo_default" bottom="ListView00:5" left="1.86%" right="Combo00_00:10"/>
        <Button id="Button01" taborder="5" text="삭제" width="70" bottom="ListView00:5" cssclass="btn_dafault" height="35" right="1.96%"/>
        <Button id="btn_allselect" taborder="4" text="전체 선택" onclick="btn_allselect_onclick" bottom="ListView00:5" right="Button01:10" cssclass="btn_dafault" width="70" height="35"/>
        <Static id="product_db" taborder="6" left="584" top="104" width="102" height="17"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="product">
        <ColumnInfo>
          <Column id="PRODUCT_CODE" type="STRING" size="256" description="제품코드"/>
          <Column id="PRODUCT_NAME" type="STRING" size="256" description="제품명"/>
          <Column id="PRODUCT_PRICE" type="INT" size="256" description="제품가격"/>
          <Column id="SEC_NAME" type="STRING" size="256" description="종류"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="Dataset00">
        <ColumnInfo>
          <Column id="ch" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[
//화면 시작 시
this.BookCafe_ProductManagemnet_Modify_oninit = function(obj:nexacro.Form,e:nexacro.EventInfo)
{
	//제품 데이터 가져오기
	
	var product_id ="product_date"
	var product_url ="svc::getproduct_date.do"
	var product_set = "";
	var product_get = "product = product";
	var product_arg =""
	var product_callback = "fn_product";
	
	this.transaction(product_id, product_url, product_set, product_get, product_arg, product_callback)
	
};

//콜백 함수
this.fn_product = function(id, code, message){
	
	if(code == 0){
		
		if(id = "product_date"){
		this.product_db.set_text("등록된 물품 갯수: " + this.product.getRowCount());
		
		}
	}
}



this.ListView00_oncellclick = function(obj:nexacro.ListView,e:nexacro.ListViewClickEventInfo)
{
	if(e.cellid == 'btn_modi'){ // 수정버튼
	this.modify(e.row)
	
	}else if(e.cellid = 'btn_del'){//삭제버튼
	this.del(e.row)
	}
};

this.modify = function(v){
	
	


}

this.del = function(v){


}



this.btn_allselect_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var select = this.product.getRowCount();
	alert(select)
};
]]></Script>
  </Form>
</FDL>
>>>>>>> refs/remotes/origin/ha_3
